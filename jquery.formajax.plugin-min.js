/** @preserve
 * The MIT License (MIT) https://github.com/dlepera88-jquery/jquery-form-ajax/blob/master/LICENSE
 * Copyright (c) 2017 Diego Lepera http://diegolepera.xyz/
 */
void 0===jQuery&&console.warn("[Plugin $.fn.formAjax] O jQuery ainda não foi inciado.\nPara utilizar esse plugin é necessário inicializar o jQuery antes."),function(e){var a={},t={serialize:function(a){var t=[];return e.merge(a.find("input:not(:file), select, textarea"),a.filter("input:not(:file), select, textarea")).each(function(){var a,n,i,o=e(this);if(!o.prop("disabled")){if(void 0===(a=o.attr("name")))return;if(o.is("select[multiple]"))o.find("option").each(function(){o.prop("selected")&&t.push(a+"="+this.value)});else{switch(n=o.attr("type"),i=encodeURIComponent(o.val()),n){case"checkbox":if("on"===i)i=o.prop("checked")?"on":"off";else if(!o.prop("checked"))return;break;case"radio":if(!o.prop("checked"))return}t.push(a+"="+i)}}}),t.join("&")},submeter:function(n,i){var o,r=Object.keys(a),s=r.length;if(i=e.extend(!0,{acao:n.attr("action"),metodo:n.attr("method"),func_antes:null,func_depois:null},i),s>0){var f,c;o=new FormData;for(var l=0;l<s;l++)if(f=r[l],(c=Object.keys(a[f]).length)>1)for(var u=0;u<c;u++)o.append(f+"[]",a[f][u]);else o.append(f,a[f][0]);e.each(t.serialize(n).split("&"),function(e,a){var t,n=/^([\w\-\[\]]+)=(.+)?$/;n.test(a)&&(t=n.exec(a),o.append(t[1],t[2]||""))})}e.ajax({url:i.acao,type:i.metodo,data:o||t.serialize(n),cache:!1,processData:0===s,contentType:!(s>0)&&"application/x-www-form-urlencoded",success:function(e,a,o){return e=t.tratarResposta(e),"function"==typeof i.func_depois?i.func_depois.apply(this,[e,n.get(0),o]):(console.warn("[Plugin $.fn.formAjax] Considere utilizar o plugin $.mostrarMsg para melhorar a experiência do usuário ao receber a resposta do submit."),console.log(e),!0)}})},validarCampo:function(e,a,t){return e?a.setCustomValidity(t):a.validity.valid||a.validationMessage!==t?null:a.setCustomValidity("")},tratarResposta:function(a){return a=a.trim(),/^[?\[{]{1,}(.+)[}\]{1,}]?$/.test(a)&&(/^\[/.test(a)||(a=a.substring(a.lastIndexOf("{"))),a=e.parseJSON(a)),a}},n={arquivosUpload:function(t){var n=t.find(":file");"multipart/form-data"===t.attr("enctype")&&n.length>0&&n.on("change."+e.fn.formAjax.evt_ns,function(e){a[this.name]=e.target.files})},alternarMaskFone:function(){e('[data-acao="alterar-mask-telefone"]').on("change."+e.fn.formAjax.evt_ns,function(){var a=e(this),t=e("#"+a.data("acao-param-telefone"));t.mascara(a.prop("checked")?t.data("mask9"):t.data("mask8")).trigger("focus")})},validacoesAdicionais:function(a){a.find("[data-vld-func]").off("."+e.fn.formAjax.evt_ns).on("change."+e.fn.formAjax.evt_ns+" blur."+e.fn.formAjax.evt_ns,function(a){var n=e(this),i=a.target,o=window[n.data("vld-func")],r=n.data("vld-msg"),s="file"===this.type?{arq:i.files,exts:n.data("vld-exts"),max:n.data("vld-max")}:n.val();return"function"!=typeof o?(console.error("A função "+o+" não existe ou não pode ser acessada!"),!1):t.validarCampo(""!==s&&!o(s),i,r)}).trigger("change."+e.fn.formAjax.evt_ns)}},i={init:function(a){return a=e.extend(!0,{validar_invisiveis:!1,func_antes:null,func_depois:null},a),this.each(function(){if("FORM"===this.tagName){var i=e(this);for(var o in n)n[o](i);i.off("."+e.fn.formAjax.evt_ns).on("submit."+e.fn.formAjax.evt_ns,{acao:i.attr("action"),metodo:i.attr("method"),func_antes:a.func_antes,func_depois:a.func_depois},function(a,n){if(a.stopPropagation(),a.preventDefault(),"function"==typeof(n=e.extend(!0,a.data,n)).func_antes&&!n.func_antes.apply(this,[this]))return!1;t.submeter(e(this),n)}),a.validar_invisiveis||i.find(":submit").off("."+e.fn.formAjax.evt_ns).on("click."+e.fn.formAjax.evt_ns,function(){var a=e(this).parents("form"),t=a.find("[required]:not(:visible)");t.prop("disabled",!0),a[0].checkValidity()||t.prop("disabled",!1)})}else console.warn("[Plugin $.fn.formAjax] Esse plugin deve ser inicializado apenas em formulários (<form></form>).")})},"submit-alternativo":function(a){return this.each(function(){e(this).trigger("submit",a)})}};e.fn.formAjax=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):e&&"object"!=typeof e&&"init"!==e?void console.error("[Plugin $.fn.formAjax] O método [%s] não foi localizado!",e):i.init.apply(this,arguments)},e.fn.formAjax.evt_ns="__formAjax"}(jQuery);